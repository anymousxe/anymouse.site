<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anymouse AI Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0a0a0a; color: white; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6">

    <div class="glass w-full max-w-2xl p-8 rounded-2xl shadow-2xl">
        <h1 class="text-3xl font-bold mb-2 text-blue-500">Anymouse AI Studio</h1>
        <p class="text-gray-400 mb-6">Sora 2 & NB Pro Access</p>

        <div id="auth-section" class="mb-6">
            <button id="login-btn" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-medium transition">Login with Google</button>
            <p id="user-info" class="hidden text-sm text-gray-300"></p>
        </div>

        <div class="flex gap-4 mb-6">
            <button onclick="setModel('nbpro')" id="btn-nbpro" class="flex-1 p-4 rounded-xl border-2 border-blue-500 bg-blue-500/10 text-center transition">
                <span class="block text-lg font-bold">NB Pro</span>
                <span class="text-xs text-gray-400">Gemini 3 Pro Images</span>
            </button>
            <button onclick="setModel('sora')" id="btn-sora" class="flex-1 p-4 rounded-xl border-2 border-transparent bg-white/5 text-center transition">
                <span class="block text-lg font-bold">Sora 2</span>
                <span class="text-xs text-gray-400">AI Video Generation</span>
            </button>
        </div>

        <textarea id="prompt-input" placeholder="Enter your prompt here..." 
            class="w-full h-32 bg-black/40 border border-white/10 rounded-xl p-4 text-white focus:ring-2 focus:ring-blue-500 outline-none transition mb-4"></textarea>
        
        <button id="gen-btn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 py-4 rounded-xl font-bold text-lg hover:opacity-90 transition shadow-lg">
            GENERATE
        </button>

        <div id="status" class="mt-6 hidden p-4 rounded-lg bg-white/5 border border-white/10 italic text-gray-400">
            Working on it... this takes about 60 seconds.
        </div>
        
        <div id="result-container" class="mt-6 hidden">
            <p class="text-sm mb-2 text-gray-400">Result:</p>
            <div id="output" class="rounded-xl overflow-hidden border border-white/20"></div>
        </div>
    </div>

    <div id="admin-panel" class="hidden mt-8 glass w-full max-w-2xl p-6 rounded-2xl border-yellow-500/30">
        <h2 class="text-yellow-500 font-bold mb-4 uppercase tracking-widest text-sm">Admin Panel: anymousexe.info@gmail.com</h2>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="text-xs text-gray-500 block mb-1">NB PRO LIMIT (Daily)</label>
                <input type="number" id="limit-nb" class="bg-black border border-white/10 p-2 rounded w-full" value="5">
            </div>
            <div>
                <label class="text-xs text-gray-500 block mb-1">SORA 2 LIMIT (Daily)</label>
                <input type="number" id="limit-sora" class="bg-black border border-white/10 p-2 rounded w-full" value="2">
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDQacpiI3oIqOUx8ciMfdlQgBtHZEVdcMo",
            authDomain: "anymousxe-aistudio.firebaseapp.com",
            projectId: "anymousxe-aistudio",
            storageBucket: "anymousxe-aistudio.firebasestorage.app",
            messagingSenderId: "518478280058",
            appId: "1:518478280058:web:422404fc54c21e5ea312c3"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        let currentModel = 'nbpro';

        window.setModel = (m) => {
            currentModel = m;
            document.getElementById('btn-nbpro').className = m === 'nbpro' ? 'flex-1 p-4 rounded-xl border-2 border-blue-500 bg-blue-500/10 text-center transition' : 'flex-1 p-4 rounded-xl border-2 border-transparent bg-white/5 text-center transition';
            document.getElementById('btn-sora').className = m === 'sora' ? 'flex-1 p-4 rounded-xl border-2 border-blue-500 bg-blue-500/10 text-center transition' : 'flex-1 p-4 rounded-xl border-2 border-transparent bg-white/5 text-center transition';
        }

        document.getElementById('login-btn').onclick = () => signInWithPopup(auth, new GoogleAuthProvider());

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('login-btn').classList.add('hidden');
                document.getElementById('user-info').innerText = `Logged in as: ${user.email}`;
                document.getElementById('user-info').classList.remove('hidden');
                if (user.email === 'anymousexe.info@gmail.com') {
                    document.getElementById('admin-panel').classList.remove('hidden');
                }
            }
        });

        document.getElementById('gen-btn').onclick = async () => {
            const prompt = document.getElementById('prompt-input').value;
            if(!prompt) return alert("Type something first!");

            document.getElementById('status').classList.remove('hidden');
            
            try {
                const response = await fetch(`/api/${currentModel}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt })
                });
                const data = await response.json();
                
                if(data.success) {
                    document.getElementById('result-container').classList.remove('hidden');
                    document.getElementById('output').innerHTML = currentModel === 'nbpro' ? 
                        `<img src="${data.url}" class="w-full">` : 
                        `<video src="${data.url}" controls class="w-full"></video>`;
                } else {
                    alert("Error: " + data.error);
                }
            } catch (e) {
                alert("Request failed. Vercel might have timed out.");
            } finally {
                document.getElementById('status').classList.add('hidden');
            }
        };
    </script>
</body>
</html>
